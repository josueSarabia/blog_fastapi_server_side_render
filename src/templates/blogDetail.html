<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="{{ url_for('static', path='/css/signup/style.css') }}">
		<link rel="stylesheet" href="{{ url_for('static', path='/css/bootstrap/bootstrap.min.css') }}">
		<link rel="stylesheet" href="{{ url_for('static', path='/css/blog/mediumish.css') }}">
		<title>Blog</title>
	</head>

	<body style="padding: 0; background: #f8f8f8;">
		<nav class="navbar navbar-expand-lg bg-light bg-white fixed-top">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<ul class="navbar-nav ms-auto mb-2 mb-lg-0">
						<li class="nav-item">
							<a class="nav-link" href="/blogs/">Blogs</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="/user/blogs/">Mis blogs</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="/profile/">Perfil</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" style="cursor: pointer;" id="logoutbutton">Cerrar sesi√≥n</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>
		<div class="main" style="margin-top: 55px; height: 100%; display: flex; justify-content: center; align-items: center; padding: 0 !important;" >
			<div class="col">
				<div class="container" style="height: 100%;">
					<div class="row">
		
						<div class="col-md-2 col-xs-12">
							<div class="share">
								<p>
									Comparte
								</p>
								<ul>
									<li>
										<a  style="cursor: pointer;">
											<svg id="shareBlogButton{{data.blog.id|safe}}" xmlns="http://www.w3.org/2000/svg" width="29" height="29" fill="currentColor" class="bi bi-share" viewBox="0 0 29 29">
												<path d="M13.5 1a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zM11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5zm-8.5 4a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm11 5.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z"/>
											</svg>
										</a>
									</li>
								</ul>
							</div>
						</div>
		
						<div class="col-md-8 col-md-offset-2 col-xs-12">
							<div class="mainheading">
				
								<h1 class="posttitle">18 Things You Should Learn Before Moving Into a New Home</h1>
				
							</div>
							<div id="contentDetail" class="article-post">
								<!-- <p>
									Holy grail funding non-disclosure agreement advisor ramen bootstrapping ecosystem. Beta crowdfunding iteration assets business plan paradigm shift stealth mass market seed money rockstar niche market marketing buzz market.
								</p>
								<p>
									Burn rate release facebook termsheet equity technology. Interaction design rockstar network effects handshake creative startup direct mailing. Technology influencer direct mailing deployment return on investment seed round.
								</p>
								<p>
									Termsheet business model canvas user experience churn rate low hanging fruit backing iteration buyer seed money. Virality release launch party channels validation learning curve paradigm shift hypotheses conversion. Stealth leverage freemium venture startup business-to-business accelerator market.
								</p>
								<blockquote>
									Gen-z strategy long tail churn rate seed money channels user experience incubator startup partner network low hanging fruit direct mailing. Client backing success startup assets responsive web design burn rate A/B testing metrics first mover advantage conversion.
								</blockquote>
								<p>
									Freemium non-disclosure agreement lean startup bootstrapping holy grail ramen MVP iteration accelerator. Strategy market ramen leverage paradigm shift seed round entrepreneur crowdfunding social proof angel investor partner network virality.
								</p> -->
							</div>
						</div>
					</div>

					<div class="row">
						<div class="col">

							<div class="row d-flex justify-content-center mb-3">
								<div class="col-md-12 col-lg-10 col-xl-8">
									<button type="button" id="addcommentbutton" class="btn btn-primary"> agregar commentario </button>
								</div>
							</div>
			
							<div class="row d-flex justify-content-center">
								<div id="commentsCol" class="col-md-12 col-lg-10 col-xl-8">
			
								</div>
							</div>
			
							<div id="commentForm" class="row d-flex justify-content-center d-none">
								<div class="col-md-12 col-lg-10 col-xl-8">
									<div class="card">
										<div class="card-body">
											<div class="d-flex flex-start align-items-center">
			
												<div class="card-footer py-3 border-0" style="background-color: #f8f9fa;width: 100%;">
													<div class="d-flex flex-start w-100">
														<div class="form-outline w-100">
															<textarea class="form-control" id="commentTextArea" rows="4" style="background: #fff;"
																placeholder="Escribe..."></textarea>
														</div>
													</div>
													<div class="float-end mt-2 pt-1">
														<button id="saveCommentButton" type="button" class="btn btn-primary btn-sm">
															<span id="saveloadingbutton" class=""></span>
															Guardar
														</button>
														<button id="cancelCommentButton" type="button" class="btn btn-outline-primary btn-sm">
															<span id="cancelloadingbutton" class=""></span>
															Cancelar
														</button>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	
		<script src="{{ url_for('static', path='/js/bootstrap/bootstrap.min.js') }}"></script>
		<script src="{{ url_for('static', path='/js/comment.js') }}"></script>
		<script src="{{ url_for('static', path='/js/logout.js') }}"></script>
		<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
		<script src="sweetalert2.all.min.js"></script>
		<script>
			function shareBlog(event) {
				event.preventDefault()
				event.stopPropagation()
				let targetBlog = event.target
				let blogId = targetBlog.id.replace("shareBlogButton", "").replaceAll('"', '')
				

				fetch("http://localhost:8000/blogs/share/", {
					method: "post",
					headers: {
						"Content-Type": "application/json"
					},
					body: JSON.stringify({
						id: blogId,
					}),
				}).then(async (response) => {

					if (response.status == 201) {
						Swal.fire({
							title: 'Blog Compartido!',
							text: 'El blog ha sido compartido exitosamente.',
							icon: 'success',
							confirmButtonText: 'Ok, entendido.'
						})
					} else if (response.status == 400) {
						const body = await response.json()
						if (body.detail == "Cant share a blog more than once") {
							Swal.fire({
								title: 'Error!',
								text: 'Ya has compartido este blog y no puedes hacerlo nuevamente.',
								icon: 'error',
								confirmButtonText: 'Ok, entendido.'
							})
						}
					}
				});
			}

			window.onload = function () {
				let id = '{{data.blog.id}}'

				const btnLogout = document.getElementById("logoutbutton");
				btnLogout.addEventListener('click', function (event) {
					logout()
				}, false)

				const shareBlogButton = document.getElementById('shareBlogButton' + id);
					shareBlogButton.addEventListener('click', function (event) {
						shareBlog(event)
					}, false)

					const contentDetail = document.getElementById("contentDetail");
					contentDetail.innerHTML = `{{ data.blog.content|safe }}`

				load(id)
			}
		</script>
	
	</body>

	
</html>